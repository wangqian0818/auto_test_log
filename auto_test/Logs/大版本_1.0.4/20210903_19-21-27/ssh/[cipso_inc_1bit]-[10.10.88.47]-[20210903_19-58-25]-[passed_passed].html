<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title>测试报告</title>
    <style>body {
	font-family: Helvetica, Arial, sans-serif;
	font-size: 12px;
	min-width: 1200px;
	color: #999;
}

h1 {
	font-size: 24px;
	color: black;
}

h2 {
	font-size: 16px;
	color: black;
}

p {
    color: black;
}

a {
	color: #999;
}

table {
	border-collapse: collapse;
}

/******************************
 * SUMMARY INFORMATION
 ******************************/

#environment td {
	padding: 5px;
	border: 1px solid #E6E6E6;
}

#environment tr:nth-child(odd) {
	background-color: #f6f6f6;
}

/******************************
 * TEST RESULT COLORS
 ******************************/
span.passed, .passed .col-result {
	color: green;
}
span.skipped, span.xfailed, span.rerun, .skipped .col-result, .xfailed .col-result, .rerun .col-result {
	color: orange;
}
span.error, span.failed, span.xpassed, .error .col-result, .failed .col-result, .xpassed .col-result  {
	color: red;
}


/******************************
 * RESULTS TABLE
 *
 * 1. Table Layout
 * 2. Extra
 * 3. Sorting items
 *
 ******************************/

/*------------------
 * 1. Table Layout
 *------------------*/

#results-table {
	border: 1px solid #e6e6e6;
	color: #999;
	font-size: 12px;
	width: 100%
}

#results-table th, #results-table td {
	padding: 5px;
	border: 1px solid #E6E6E6;
	text-align: left
}
#results-table th {
	font-weight: bold
}

/*------------------
 * 2. Extra
 *------------------*/

.log:only-child {
	height: inherit
}
.log {
	background-color: #e6e6e6;
	border: 1px solid #e6e6e6;
	color: black;
	display: block;
	font-family: "Courier New", Courier, monospace;
	height: 230px;
	overflow-y: scroll;
	padding: 5px;
	white-space: pre-wrap
}
div.image {
	border: 1px solid #e6e6e6;
	float: right;
	height: 240px;
	margin-left: 5px;
	overflow: hidden;
	width: 320px
}
div.image img {
	width: 320px
}
.collapsed {
	display: none;
}
.expander::after {
	content: " (展开详情)";
	color: #BBB;
	font-style: italic;
	cursor: pointer;
}
.collapser::after {
	content: " (隐藏详情)";
	color: #BBB;
	font-style: italic;
	cursor: pointer;
}

/*------------------
 * 3. Sorting items
 *------------------*/
.sortable {
	cursor: pointer;
}

.sort-icon {
	font-size: 0px;
	float: left;
	margin-right: 5px;
	margin-top: 5px;
	/*triangle*/
	width: 0;
	height: 0;
	border-left: 8px solid transparent;
	border-right: 8px solid transparent;
}

.inactive .sort-icon {
	/*finish triangle*/
	border-top: 8px solid #E6E6E6;
}

.asc.active .sort-icon {
	/*finish triangle*/
	border-bottom: 8px solid #999;
}

.desc.active .sort-icon {
	/*finish triangle*/
	border-top: 8px solid #999;
}
</style></head>
  <body onLoad="init()">
    <script>/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this file,
 * You can obtain one at http://mozilla.org/MPL/2.0/. */


function toArray(iter) {
    if (iter === null) {
        return null;
    }
    return Array.prototype.slice.call(iter);
}

function find(selector, elem) {
    if (!elem) {
        elem = document;
    }
    return elem.querySelector(selector);
}

function find_all(selector, elem) {
    if (!elem) {
        elem = document;
    }
    return toArray(elem.querySelectorAll(selector));
}

function sort_column(elem) {
    toggle_sort_states(elem);
    var colIndex = toArray(elem.parentNode.childNodes).indexOf(elem);
    var key;
    if (elem.classList.contains('numeric')) {
        key = key_num;
    } else if (elem.classList.contains('result')) {
        key = key_result;
    } else {
        key = key_alpha;
    }
    sort_table(elem, key(colIndex));
}

function show_all_extras() {
    find_all('.col-result').forEach(show_extras);
}

function hide_all_extras() {
    find_all('.col-result').forEach(hide_extras);
}

function show_extras(colresult_elem) {
    var extras = colresult_elem.parentNode.nextElementSibling;
    var expandcollapse = colresult_elem.firstElementChild;
    extras.classList.remove("collapsed");
    expandcollapse.classList.remove("expander");
    expandcollapse.classList.add("collapser");
}

function hide_extras(colresult_elem) {
    var extras = colresult_elem.parentNode.nextElementSibling;
    var expandcollapse = colresult_elem.firstElementChild;
    extras.classList.add("collapsed");
    expandcollapse.classList.remove("collapser");
    expandcollapse.classList.add("expander");
}

function show_filters() {
    var filter_items = document.getElementsByClassName('filter');
    for (var i = 0; i < filter_items.length; i++)
        filter_items[i].hidden = false;
}

/*
function add_collapse() {
    // Add links for show/hide all
    var resulttable = find('table#results-table');
    var showhideall = document.createElement("p");
    showhideall.innerHTML = '<a href="javascript:show_all_extras()">Show all details</a> / ' +
                            '<a href="javascript:hide_all_extras()">Hide all details</a>';
    resulttable.parentElement.insertBefore(showhideall, resulttable);*/
function add_collapse() {  // modify by linux超
    // Add links for show/hide all
    var resulttable = find('table#results-table');
    var showhideall = document.createElement("p");
    showhideall.innerHTML = '<a href="javascript:show_all_extras()">显示详情</a> / ' +
                            '<a href="javascript:hide_all_extras()">隐藏详情</a>';
    resulttable.parentElement.insertBefore(showhideall, resulttable);
    // Add show/hide link to each result
    find_all('.col-result').forEach(function(elem) {
        var collapsed = get_query_parameter('collapsed') || 'Passed';
        var extras = elem.parentNode.nextElementSibling;
        var expandcollapse = document.createElement("span");
        if (collapsed.includes(elem.innerHTML)) {
            extras.classList.add("collapsed");
            expandcollapse.classList.add("expander");
        } else {
            expandcollapse.classList.add("collapser");
        }
        elem.appendChild(expandcollapse);

        elem.addEventListener("click", function(event) {
            if (event.currentTarget.parentNode.nextElementSibling.classList.contains("collapsed")) {
                show_extras(event.currentTarget);
            } else {
                hide_extras(event.currentTarget);
            }
        });
    })
}

function get_query_parameter(name) {
    var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);
    return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
}

function init () {
    reset_sort_headers();

    add_collapse();

    show_filters();

    toggle_sort_states(find('.initial-sort'));

    find_all('.sortable').forEach(function(elem) {
        elem.addEventListener("click",
                              function(event) {
                                  sort_column(elem);
                              }, false)
    });
	// 修改用例报告显示的用例名称 add by linux超
	var case_name_td = document.getElementsByClassName("col-name");
		for(var i = 0; i < case_name_td.length; i++)
			try{
				case_name_td[i].innerText = case_name_td[i].innerText.split("\[")[1].split("\]")[0];
			}
			catch(err){
				// 如果表格中没有[]会抛异常，如果抛异常我就显示null，如果你想显示别的东西自己改吧，因为通常只要我们使用参数化就有[]显示
				case_name_td[i].innerText = "测试用例无参数化数据null";
			}

};

function sort_table(clicked, key_func) {
    var rows = find_all('.results-table-row');
    var reversed = !clicked.classList.contains('asc');
    var sorted_rows = sort(rows, key_func, reversed);
    /* Whole table is removed here because browsers acts much slower
     * when appending existing elements.
     */
    var thead = document.getElementById("results-table-head");
    document.getElementById('results-table').remove();
    var parent = document.createElement("table");
    parent.id = "results-table";
    parent.appendChild(thead);
    sorted_rows.forEach(function(elem) {
        parent.appendChild(elem);
    });
    document.getElementsByTagName("BODY")[0].appendChild(parent);
}

function sort(items, key_func, reversed) {
    var sort_array = items.map(function(item, i) {
        return [key_func(item), i];
    });
    var multiplier = reversed ? -1 : 1;

    sort_array.sort(function(a, b) {
        var key_a = a[0];
        var key_b = b[0];
        return multiplier * (key_a >= key_b ? 1 : -1);
    });

    return sort_array.map(function(item) {
        var index = item[1];
        return items[index];
    });
}

function key_alpha(col_index) {
    return function(elem) {
        return elem.childNodes[1].childNodes[col_index].firstChild.data.toLowerCase();
    };
}

function key_num(col_index) {
    return function(elem) {
        return parseFloat(elem.childNodes[1].childNodes[col_index].firstChild.data);
    };
}

function key_result(col_index) {
    return function(elem) {
        var strings = ['Error', 'Failed', 'Rerun', 'XFailed', 'XPassed',
                       'Skipped', 'Passed'];
        return strings.indexOf(elem.childNodes[1].childNodes[col_index].firstChild.data);
    };
}

function reset_sort_headers() {
    find_all('.sort-icon').forEach(function(elem) {
        elem.parentNode.removeChild(elem);
    });
    find_all('.sortable').forEach(function(elem) {
        var icon = document.createElement("div");
        icon.className = "sort-icon";
        icon.textContent = "vvv";
        elem.insertBefore(icon, elem.firstChild);
        elem.classList.remove("desc", "active");
        elem.classList.add("asc", "inactive");
    });
}

function toggle_sort_states(elem) {
    //if active, toggle between asc and desc
    if (elem.classList.contains('active')) {
        elem.classList.toggle('asc');
        elem.classList.toggle('desc');
    }

    //if inactive, reset all other functions and add ascending active
    if (elem.classList.contains('inactive')) {
        reset_sort_headers();
        elem.classList.remove('inactive');
        elem.classList.add('active');
    }
}

function is_all_rows_hidden(value) {
  return value.hidden == false;
}

function filter_table(elem) {
    var outcome_att = "data-test-result";
    var outcome = elem.getAttribute(outcome_att);
    class_outcome = outcome + " results-table-row";
    var outcome_rows = document.getElementsByClassName(class_outcome);

    for(var i = 0; i < outcome_rows.length; i++){
        outcome_rows[i].hidden = !elem.checked;
    }

    var rows = find_all('.results-table-row').filter(is_all_rows_hidden);
    var all_rows_hidden = rows.length == 0 ? true : false;
    var not_found_message = document.getElementById("not-found-message");
    not_found_message.hidden = !all_rows_hidden;
}
</script>
    <h1>[cipso_inc_1bit]-[10.10.88.47]-[20210903_19-58-25].html</h1>
    <p>生成报告时间03-Sep-2021 19:58:41 Pytest-Html版本：<a href="https://pypi.python.org/pypi/pytest-html">pytest-html</a> v1.22.1.dev11+g4f729c1</p>
    <h2>测试环境</h2>
    <table id="environment">
      <tr>
        <td>Base URL</td>
        <td></td></tr>
      <tr>
        <td>Packages</td>
        <td>{&apos;pytest&apos;: &apos;4.5.0&apos;, &apos;py&apos;: &apos;1.10.0&apos;, &apos;pluggy&apos;: &apos;0.13.1&apos;}</td></tr>
      <tr>
        <td>Platform</td>
        <td>Windows-10-10.0.18362-SP0</td></tr>
      <tr>
        <td>Plugins</td>
        <td>{&apos;allure-pytest&apos;: &apos;2.8.6&apos;, &apos;assume&apos;: &apos;2.4.2&apos;, &apos;base-url&apos;: &apos;1.4.2&apos;, &apos;cov&apos;: &apos;2.10.1&apos;, &apos;forked&apos;: &apos;1.3.0&apos;, &apos;instafail&apos;: &apos;0.4.2&apos;, &apos;metadata&apos;: &apos;1.11.0&apos;, &apos;ordering&apos;: &apos;0.6&apos;, &apos;reportlog&apos;: &apos;0.1.2&apos;, &apos;rerunfailures&apos;: &apos;9.1.1&apos;, &apos;sugar&apos;: &apos;0.9.4&apos;, &apos;xdist&apos;: &apos;2.2.0&apos;, &apos;html&apos;: &apos;1.22.1.dev11+g4f729c1&apos;}</td></tr>
      <tr>
        <td>Python</td>
        <td>3.6.6</td></tr>
      <tr>
        <td>用例执行时间</td>
        <td>2021-09-03 19:58:26</td></tr>
      <tr>
        <td>设备IP</td>
        <td>10.10.88.47</td></tr></table>
    <h2>用例统计</h2>
    <p>所属部门: 卓讯-合肥测试部</p>
    <p>测试人员: 王谦</p>
    <p>【 -------------------------- 网关设备版本号 ----------------------------- 】</p>
    <p>【 agentjsac-1.1.906-rc.x86_64 】</p>
    <p>【 driverjsac-1.1.897-rc.x86_64 】</p>
    <p>【 libhostapi-1.1.897-rc.x86_64 】</p>
    <p>【 tsthostapi-1.1.897-rc.x86_64 】</p>
    <p>【 nginx-0.0.474-kernel_rc.x86_64 】</p>
    <p>执行了2个测试用例, 历时:14.85秒 . </p>
    <p class="filter" hidden="true">(取消)勾选复选框, 以便筛选测试结果</p><input checked="true" class="filter" data-test-result="passed" hidden="true" name="filter_checkbox" onChange="filter_table(this)" type="checkbox"/><span class="passed">2 通过</span>, <input checked="true" class="filter" data-test-result="skipped" disabled="true" hidden="true" name="filter_checkbox" onChange="filter_table(this)" type="checkbox"/><span class="skipped">0 跳过</span>, <input checked="true" class="filter" data-test-result="failed" disabled="true" hidden="true" name="filter_checkbox" onChange="filter_table(this)" type="checkbox"/><span class="failed">0 失败</span>, <input checked="true" class="filter" data-test-result="error" disabled="true" hidden="true" name="filter_checkbox" onChange="filter_table(this)" type="checkbox"/><span class="error">0 错误</span>, <input checked="true" class="filter" data-test-result="xfailed" disabled="true" hidden="true" name="filter_checkbox" onChange="filter_table(this)" type="checkbox"/><span class="xfailed">0 预期失败</span>, <input checked="true" class="filter" data-test-result="xpassed" disabled="true" hidden="true" name="filter_checkbox" onChange="filter_table(this)" type="checkbox"/><span class="xpassed">0 预期通过</span>, <input checked="true" class="filter" data-test-result="重跑" disabled="true" hidden="true" name="filter_checkbox" onChange="filter_table(this)" type="checkbox"/><span class="重跑">0 重跑</span>
    <h2>测试结果</h2>
    <table id="results-table">
      <thead id="results-table-head">
        <tr>
          <th class="sortable result initial-sort" col="result">通过/失败</th>
          <th class="sortable time" col="time">Time</th>
          <th>Test_nodeId</th>
          <th class="sortable numeric" col="duration">耗时</th></tr>
        <tr hidden="true" id="not-found-message">
          <th colspan="4">无测试结果, 试着选择其他测试结果条件</th></tr></thead>
      <tbody class="passed results-table-row">
        <tr>
          <td class="col-result">Passed</td>
          <td class="col-time">2021-09-03 11:58:31.869579</td>
          <td>Case_ssh/cipso_inc_1bit/function.py::Test_cipso_inc_1bit::test_cipso_inc</td>
          <td class="col-duration">1.70</td></tr>
        <tr>
          <td class="extra" colspan="4">
            <div class="log">---------------------------- Captured stdout setup -----------------------------<br/>ssh 连接开始
ssh连接主机：10.10.88.47  完成!
ssh服务器: 10.10.88.47连接成功
ssh 连接开始
ssh连接主机：10.10.88.148  完成!
ssh服务器: 10.10.88.148连接成功
ssh 连接开始
ssh连接主机：10.10.88.149  完成!
ssh服务器: 10.10.88.149连接成功
export cardid=0&amp;&amp;switch-jsac --set --switch on
Set successfully.

export cardid=0&amp;&amp;switch-jsac --set --module 12 --switch off
Set successfully.

export cardid=0&amp;&amp;switch-jsac --set --module 13 --switch off
Set successfully.

export cardid=0&amp;&amp;switch-jsac --set --module 15 --switch off
Set successfully.

export cardid=0&amp;&amp;switch-jsac --set --module 16 --switch off
Set successfully.

export cardid=0&amp;&amp;switch-jsac --set --module 17 --switch off
Set successfully.

export cardid=0&amp;&amp;defconf  --action forward
Success.

export cardid=0&amp;&amp;defconf --selabel on
Success.

export cardid=0&amp;&amp;defconf --cycle 15
Success.

export cardid=0&amp;&amp;defconf --ipv4aclcycle 30
Success.

export cardid=0&amp;&amp;defconf --domain off
Success.

export cardid=0&amp;&amp;defconf --netflow off
Success.

export cardid=0&amp;&amp;defconf --ipv4acl off
Success.

export cardid=0&amp;&amp;defconf --syncookie off
Success.

export cardid=0&amp;&amp;defconf --ckoption off
Success.

export cardid=0&amp;&amp;defconf --noflow off
Success.

export cardid=0&amp;&amp;defconf --droperr off
Success.

export cardid=0&amp;&amp;defconf --tcpmss 0
Success.

=========================== clear_env 结束 耗时：2.193641185760498s ==================================
export cardid=0&amp;&amp;tupleacl --clear
Clear all rules successfully.

export cardid=0&amp;&amp;selabel --clear
Clear successfully.

export cardid=0&amp;&amp;qos-jsac --clear
Clear successfully.

export cardid=1&amp;&amp;tupleacl --clear
Clear all rules successfully.

export cardid=1&amp;&amp;selabel --clear
Clear successfully.

export cardid=1&amp;&amp;qos-jsac --clear
Clear successfully.

=========================== clear_met_acl 结束 耗时：0.779914379119873s ==================================
----------------------------- Captured stdout call -----------------------------<br/>1.客户端下发管理口标记策略，命令iptables -I POSTROUTING -t mangle -p tcp -j CIPSO --doi 16 --level 12 --cat 0x18,0x8,0x7,0x6 -d {cipso_dip} --dport 80，使用iptables -t mangle -nL命令查看策略包含level 12
Chain PREROUTING (policy ACCEPT)
target     prot opt source               destination         

Chain INPUT (policy ACCEPT)
target     prot opt source               destination         

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         

Chain POSTROUTING (policy ACCEPT)
target     prot opt source               destination         
CIPSO      tcp  --  0.0.0.0/0            10.10.88.149         tcp dpt:80 --doi 16 --level 12 --cat 0x18,0x8,0x7,0x6

2.服务端下发管理口标记策略，命令iptables -I PREROUTING -t mangle -p tcp -m cipso --doi 16 --level 12 --biba --inc  --cat 0x58,0xa,0xf,0x6 -s {cipso_sip} --dport 80 -j CIPSO --rm，使用iptables -t mangle -nL命令查看策略包含inc
Chain PREROUTING (policy ACCEPT)
target     prot opt source               destination         
CIPSO      tcp  --  10.10.88.148         0.0.0.0/0            --doi 16 --level 12 --biba --inc --cat 0x58,0xa,0xf,0x6 tcp dpt:80 --rm

Chain INPUT (policy ACCEPT)
target     prot opt source               destination         

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         

Chain POSTROUTING (policy ACCEPT)
target     prot opt source               destination         

3.在客户端使用curl命令发送http请求，命令curl http://{cipso_dip}:80 &gt;/opt/cipso.txt，服务端nginx服务返回结果为Welcome to nginx!即为正常
curl http://10.10.88.149:80 &gt;/opt/cipso.txt
当前时间为2021-09-03 19:58:30
第一次获取的结果为：&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Welcome to nginx!&lt;/title&gt;
&lt;style&gt;
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
&lt;p&gt;If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.&lt;/p&gt;

&lt;p&gt;For online documentation and support please refer to
&lt;a href=&quot;http://nginx.org/&quot;&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
Commercial support is available at
&lt;a href=&quot;http://nginx.com/&quot;&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;

正常http请求发送成功
4.客户端移除管理口标记策略，命令iptables -D POSTROUTING -t mangle -p tcp -j CIPSO --doi 16 --level 12 --cat 0x18,0x8,0x7,0x6 -d {cipso_dip} --dport 80，使用iptables -t mangle -nL命令查看策略不包含level 12
Chain PREROUTING (policy ACCEPT)
target     prot opt source               destination         

Chain INPUT (policy ACCEPT)
target     prot opt source               destination         

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         

Chain POSTROUTING (policy ACCEPT)
target     prot opt source               destination         

5.服务端移除管理口标记策略，命令iptables -D PREROUTING -t mangle -p tcp -m cipso --doi 16 --level 12 --biba --inc  --cat 0x58,0xa,0xf,0x6 -s {cipso_sip} --dport 80 -j CIPSO --rm，使用iptables -t mangle -nL命令查看策略不包含inc
Chain PREROUTING (policy ACCEPT)
target     prot opt source               destination         

Chain INPUT (policy ACCEPT)
target     prot opt source               destination         

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         

Chain POSTROUTING (policy ACCEPT)
target     prot opt source               destination         

6.rm -f /opt/cipso*.txt在客户端删除第3步http请求结果的文件/opt/cipso.txt，客户端ls /opt/ |grep txt查询不到cipso.txt说明文件删除成功
客户端txt文件查询结果是: 
</div></td></tr></tbody>
      <tbody class="passed results-table-row">
        <tr>
          <td class="col-result">Passed</td>
          <td class="col-time">2021-09-03 11:58:38.643756</td>
          <td>Case_ssh/cipso_inc_1bit/function.py::Test_cipso_inc_1bit::test_cipso_1bit</td>
          <td class="col-duration">1.65</td></tr>
        <tr>
          <td class="extra" colspan="4">
            <div class="log">---------------------------- Captured stdout setup -----------------------------<br/>export cardid=0&amp;&amp;switch-jsac --set --switch on
Set successfully.

export cardid=0&amp;&amp;switch-jsac --set --module 12 --switch off
Set successfully.

export cardid=0&amp;&amp;switch-jsac --set --module 13 --switch off
Set successfully.

export cardid=0&amp;&amp;switch-jsac --set --module 15 --switch off
Set successfully.

export cardid=0&amp;&amp;switch-jsac --set --module 16 --switch off
Set successfully.

export cardid=0&amp;&amp;switch-jsac --set --module 17 --switch off
Set successfully.

export cardid=0&amp;&amp;defconf  --action forward
Success.

export cardid=0&amp;&amp;defconf --selabel on
Success.

export cardid=0&amp;&amp;defconf --cycle 15
Success.

export cardid=0&amp;&amp;defconf --ipv4aclcycle 30
Success.

export cardid=0&amp;&amp;defconf --domain off
Success.

export cardid=0&amp;&amp;defconf --netflow off
Success.

export cardid=0&amp;&amp;defconf --ipv4acl off
Success.

export cardid=0&amp;&amp;defconf --syncookie off
Success.

export cardid=0&amp;&amp;defconf --ckoption off
Success.

export cardid=0&amp;&amp;defconf --noflow off
Success.

export cardid=0&amp;&amp;defconf --droperr off
Success.

export cardid=0&amp;&amp;defconf --tcpmss 0
Success.

=========================== clear_env 结束 耗时：1.7362773418426514s ==================================
export cardid=0&amp;&amp;tupleacl --clear
Clear all rules successfully.

export cardid=0&amp;&amp;selabel --clear
Clear successfully.

export cardid=0&amp;&amp;qos-jsac --clear
Clear successfully.

export cardid=1&amp;&amp;tupleacl --clear
Clear all rules successfully.

export cardid=1&amp;&amp;selabel --clear
Clear successfully.

export cardid=1&amp;&amp;qos-jsac --clear
Clear successfully.

=========================== clear_met_acl 结束 耗时：0.7493932247161865s ==================================
----------------------------- Captured stdout call -----------------------------<br/>1.客户端下发管理口标记策略，命令iptables -I POSTROUTING -t mangle -p tcp -j CIPSO --doi 16 --level 12 --cat 0x89,0x1d,0x36,0x71 -d {cipso_dip} --dport 80，使用iptables -t mangle -nL命令查看策略包含level 12
Chain PREROUTING (policy ACCEPT)
target     prot opt source               destination         

Chain INPUT (policy ACCEPT)
target     prot opt source               destination         

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         

Chain POSTROUTING (policy ACCEPT)
target     prot opt source               destination         
CIPSO      tcp  --  0.0.0.0/0            10.10.88.149         tcp dpt:80 --doi 16 --level 12 --cat 0x89,0x1d,0x36,0x71

2.服务端下发管理口标记策略，命令iptables -I PREROUTING -t mangle -p tcp -m cipso --doi 16 --level 12 --biba --1bit  --cat 0xaa,0x3,0x12,0xc9 -s {cipso_sip} --dport 80 -j CIPSO --rm，使用iptables -t mangle -nL命令查看策略包含1bit
Chain PREROUTING (policy ACCEPT)
target     prot opt source               destination         
CIPSO      tcp  --  10.10.88.148         0.0.0.0/0            --doi 16 --level 12 --biba --1bit --cat 0xaa,0x3,0x12,0xc9 tcp dpt:80 --rm

Chain INPUT (policy ACCEPT)
target     prot opt source               destination         

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         

Chain POSTROUTING (policy ACCEPT)
target     prot opt source               destination         

3.在客户端使用curl命令发送http请求，命令curl http://{cipso_dip}:80 &gt;/opt/cipso.txt，服务端nginx服务返回结果为Welcome to nginx!即为正常
curl http://10.10.88.149:80 &gt;/opt/cipso.txt
当前时间为2021-09-03 19:58:37
第一次获取的结果为：&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Welcome to nginx!&lt;/title&gt;
&lt;style&gt;
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
&lt;p&gt;If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.&lt;/p&gt;

&lt;p&gt;For online documentation and support please refer to
&lt;a href=&quot;http://nginx.org/&quot;&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
Commercial support is available at
&lt;a href=&quot;http://nginx.com/&quot;&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;

正常http请求发送成功
4.客户端下发管理口标记策略，命令iptables -D POSTROUTING -t mangle -p tcp -j CIPSO --doi 16 --level 12 --cat 0x89,0x1d,0x36,0x71 -d {cipso_dip} --dport 80，使用iptables -t mangle -nL命令查看策略不包含level 12
Chain PREROUTING (policy ACCEPT)
target     prot opt source               destination         

Chain INPUT (policy ACCEPT)
target     prot opt source               destination         

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         

Chain POSTROUTING (policy ACCEPT)
target     prot opt source               destination         

5.服务端下发管理口标记策略，命令iptables -D PREROUTING -t mangle -p tcp -m cipso --doi 16 --level 12 --biba --1bit  --cat 0xaa,0x3,0x12,0xc9 -s {cipso_sip} --dport 80 -j CIPSO --rm，使用iptables -t mangle -nL命令查看策略不包含1bit
Chain PREROUTING (policy ACCEPT)
target     prot opt source               destination         

Chain INPUT (policy ACCEPT)
target     prot opt source               destination         

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         

Chain POSTROUTING (policy ACCEPT)
target     prot opt source               destination         

6.rm -f /opt/cipso*.txt在客户端删除第3步http请求结果的文件/opt/cipso.txt，客户端ls /opt/ |grep txt查询不到cipso.txt说明文件删除成功
客户端txt文件查询结果是: 
</div></td></tr></tbody></table></body></html>